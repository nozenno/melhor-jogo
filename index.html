<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Ranking de Jogos</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; }
    .game { margin: 20px; }
    button { margin-left: 10px; }
  </style>
</head>
<body>
  <h1>Ranking dos Melhores Jogos</h1>
  <div id="ranking"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

  <script>
    // === CONFIGURAÇÃO DO FIREBASE ===
  import { initializeApp } from "firebase/app";
  import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCNe2n7336JOD7IMoTl_4_6aZ7o8-eF9qU",
  authDomain: "melhor-jogo-ba320.firebaseapp.com",
  projectId: "melhor-jogo-ba320",
  storageBucket: "melhor-jogo-ba320.firebasestorage.app",
  messagingSenderId: "1047960341287",
  appId: "1:1047960341287:web:68bdc19e5c0b4464623702",
  measurementId: "G-J5EHTVHT0X"
};

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const docRef = db.collection("jogos").doc("ranking"); // único documento

    // Carrega ranking e mostra na tela
    async function loadRanking() {
      const snapshot = await docRef.get();
      const data = snapshot.data(); // { "Half-Life 1": 0, "RE4": 0, ... }

      const rankingDiv = document.getElementById("ranking");
      rankingDiv.innerHTML = "";

      // Ordena decrescente pelos votos
      const ranking = Object.entries(data).sort((a,b) => b[1] - a[1]);

      ranking.forEach(([nome, votos], i) => {
        const div = document.createElement("div");
        div.className = "game";
        div.innerHTML = `${i+1}. ${nome} - Votos: ${votos} 
          <button onclick="vote('${nome}')">Votar</button>`;
        rankingDiv.appendChild(div);
      });
    }

    // Incrementa voto
    async function vote(jogo) {
      await docRef.update({
        [jogo]: firebase.firestore.FieldValue.increment(1)
      });
      loadRanking();
    }

    loadRanking();
  </script>
</body>
</html>
